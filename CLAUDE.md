Claude Code 八荣八耻
以瞎猜接口为耻，以认真查询为荣。
以模糊执行为耻，以寻求确认为荣。
以臆想业务为耻，以人类确认为荣。
以创造接口为耻，以复用现有为荣。
以跳过验证为耻，以主动测试为荣。
以破坏架构为耻，以遵循规范为荣。
以假装理解为耻，以诚实无知为荣。以盲目修改为耻，以谨慎重构为荣:
2025 年中国研究生数学建模竞赛 E 题 
高速列车轴承智能故障诊断问题
高速列车因其安全高效、便捷舒适、绿色低碳等优点，已经成为中国客运的
主流运输工具。轴承作为高速列车走行系统的关键旋转部件，长期处于高转速、
交变载荷等复杂恶劣的工况环境中，具有故障率高、易损坏等特点，是高速列车
走行系统设备故障的主要源头。一旦轴承发生故障，轻则导致列车延误和晚点，
重则会诱发脱轨等恶性事故，危及生命安全。
当前高铁轴承状态监测方法主要依赖于专家经验构建的特征指标或传统信
号处理技术实现。随着轨道交通系统向高密度、强耦合、智能化的方向快速发展，
现有方法在诊断精度、泛化能力和实时性方面难以满足复杂运营场景下的精准诊
断需求。近年来，随着大数据、人工智能技术的快速发展，数据驱动的智能故障
诊断方法在列车装备运维领域受到了广泛关注。基于海量运营数据构建的深度学
习模型，能够实现更高精度的故障识别、更强的工况适应性和更高效的实时诊断
能力。然而，在实际应用场景中，受复杂运行环境与多变工况的影响，传感器采
集的原始振动信号易受到背景噪声、干扰源响应等诸多成分影响，这不仅削弱了
故障特征的显著性，也直接制约了深度学习模型的识别准确率。更关键的是，为
保障列车安全运营，关键设备的异常状态通常会被及时处理，导致在途列车的真
实故障数据极度稀缺，进而造成训练数据分布严重失衡，极大地限制了深度学习
模型向工程实践的转化。与实际运行数据相对的是，在台架实验环境下采集的轴
承数据不仅数量丰富、标签完备，而且其故障演化机理也与在途列车轴承相似。
在此背景下，迁移学习技术为解决上述问题提供了良好思路。
迁移学习技术是一种新兴机器学习方法，其核心思想是将在一个任务或领域
中学到的知识迁移到另一个相关但不同的任务或领域，以提升目标任务的模型性
能。因此，通过解析轴承故障机理对既有试验台数据展开分析，提取代表性的轴
承故障特征以构建源域模型，再结合迁移学习技术将诊断知识迁移至实际运营列
车数据，可有效缓解样本不平衡问题。轴承故障特征通常可以从时域、频域、时
频域[1]和二维图像[2]等多个维度进行分析。
根据上述思路，本题给出 161 个具有代表性的轴承试验台架振动数据文件作
为问题研究的源域数据集，另外给出来自实际的 16 个轴承故障文件作为目标域
数据集，这些数据文件的相关信息见附件 1。请完成以下几项任务： 
1、数据分析与故障特征提取：请考虑目标域的迁移任务，从提供的源域数据
中筛选部分数据组成数据集。结合轴承故障机理，选择合适的方法或指标对有代
表性的源域数据进行特征分析，并对整体数据集进行特征提取，用于后续诊断任
务。（源域数据可选用其他公开轴承数据集，但应标明出处）。
2、源域故障诊断：在任务 1 提取的故障特征基础上，划分源域训练集与测
试集。设计合适的诊断模型实现源域诊断任务，并对诊断结果进行评价。
3、 迁移诊断：在任务 2 设计的诊断模型基础上，充分考虑源域与目标域的
共性与差异特征，设计合适的迁移学习方法，构建目标域诊断模型，对目标域未
知标签的数据进行分类和标定，给出迁移结果的可视化展示和分析，并给出数据
对应的标签。
4、 迁移诊断的可解释性：可解释性是机器学习领域的重要研究方向之一。
由于机器学习模型的“黑箱”问题，其迁移和诊断过程难以被观测和理解，这可
能造成使用者对模型结果的不信任或盲目信任，进而影响诊断模型的应用。迁移
诊断可解释性研究的核心目标是解决迁移学习模型在跨工况、跨设备故障诊断中
的透明性问题，提高诊断人员对迁移过程和诊断模型输出的理解和信任度。请考
虑任务 3 中模型的结构设计、迁移过程和决策过程，结合轴承故障特点与故障机
理，对迁移诊断的事前/迁移过程/事后（任选一点或多点）可解释性进行分析。
名词解释：
1）事前可解释性：模型本身具有透明的结构和决策逻辑，即“自解释”能力，
一般无需额外的解释技术即可直接理解其工作原理。
2）迁移过程可解释性：揭示知识从源域到目标域的迁移路径和共享特征情况。
分析知识是否真的实现了迁移，说明模型如何适应新工况/设备。可通过结构设
计或外部工具进行分析。
3）事后可解释性：通过外部工具或算法反推模型的决策依据，以人类可理解的
方式展现模型的决策过程和机制。
附件 1：数据集介绍 
1. 源域数据集（轴承试验台架振动数据，存在轻微噪声影响）
试验台架主体为电动机，其主要包括驱动端、风扇端和基座三部分。数据
通过安装在电动机壳体驱动端、风扇端和基座上的加速度传感器采集，驱动端
和风扇端各存在一个试验轴承。轴承由人为破坏生成单点故障（即只有单个部
位存在单一缺损），不存在复合故障，且每组数据仅有一个轴承损坏。故障的
直径有四种大小，具体情况在后文中详述。
不同位置传感器采集的振动信号能够反映不同的物理特征，从而为不同诊
断任务提供数据支持。
驱动端数据（DE）：驱动端直接连接电机转轴，从此处采集的振动信号主要
受转子旋转和传动系统的激励影响，能够清晰捕获驱动端轴承的振动信号，以及
风扇端轴承经过转轴传递后的振动信息。
风扇端数据（FE）：风扇端即电机风扇端，从此处采集的振动信号主要受叶
片旋转和风扇系统的激励影响，能够清晰捕获风扇端轴承的振动信号，以及驱动
端轴承经过转轴传递后的振动信息。
基座数据（BA）：基座即电机底座，从此处采集的振动信号受到电机整体结
构和运行状态的影响，能够反映整个电机系统的振动信息。由于多层结构传递，
振动信号故障特征高度衰减，通常用于辅助分析。
一般来说，距离故障轴承较近的采集位置振动传递路径短，故障信号的幅值
更明显（如驱动端采样驱动端故障），远端则由于传递路径较长而产生衰减（如
驱动端采样风扇端故障）。
1）试验平台轴承信息 
⚫ 待检测轴承支撑电动机转轴；
⚫ 驱动端轴承为 SKF6205，采样频率为 12KHz 和 48KHz；
⚫ 风扇端轴承为 SKF6203，采样频率为 12KHz。
轴承尺寸参数如表 1 所示。
表 1 源域数据集轴承尺寸参数
轴承类型 滚动体数 n 滚动体直径𝒅 轴承节径𝑫
SKF6205（DE） 9 0.3126 英寸 1.537 英寸
SKF6203（FE） 9 0.2656 英寸 1.122 英寸
2）数据格式和变量名称
数据文件为 MATLAB 的.mat 格式，每个文件包含的数据种类不一致。变量
名解释如下：
⚫ DE：drive end accelerometer data 驱动端加速度数据；
⚫ FE：fan end accelerometer data 风扇端加速度数据；
⚫ BA：base accelerometer data 基座加速度数据；
⚫ time：time series data 时间序列数据；
⚫ RPM: rpm during testing 转/每分钟，除以 60 为旋转频率。
3）轴承工作状态类别
在该数据集中，轴承有 4 种工作状态：外圈故障（OR）、内圈故障
（IR）、滚动体故障（B）以及正常工作状态（N）。其中外圈故障样本 77
个，内圈故障样本 40 个，滚动体故障样本 40 个，正常样本 4 个。轴承外圈故
障有 3 种故障尺寸：0.007、0.014、0.021 英寸；轴承内圈故障和滚动体故障都
有 4 种故障尺寸：0.007、0.014、0.021、0.028 英寸。由于外圈故障位置固定
（不随轴承旋转而移动），因此通过三个点位全面采集振动信号：3 点钟
（Orthogonal）、6 点钟（Centered）、12 点钟（Opposite）。轴承的载荷有四
种情况：0、1、2、3 马力。以 12kHz 下命名为“B007_0”的数据文件为例，其表
示 0 载荷下 0.007 英寸的滚动体故障（B）。其导入 MATLAB 的数据组成包括
“X118_BA_time”，“X118_DE_time”，“X118_FE_time”和“X118RPM”
四组，其中 X118 表示数据编号，BA/DE/FE 为基座/驱动端/风扇端采样信号，
RPM 为该数据的轴承转速。
如上所述，该数据集包含足够类别的通用轴承振动数据，可以根据目标需求，
筛选合适的数据进行分析和特征提取，作为源域数据集对模型进行训练。
2. 目标域数据集（列车轴承故障数据集）
该数据集包含列车滚动轴承外圈（OR）、内圈（IR）、滚动体（B）故障和
正常状态（N）下的振动信号数据，采集时间为 8 秒，采样频率为 32kHz，列车
速度约 90km/h（轴承转速约 600 rpm）。数据文件以英文字母 A~P 编号命名，各
数据所属工作状态未知。
3、源域和目标域数据集链接：
https://pan.baidu.com/s/1H8nHXyMTv085jGRaiBOr0Q?pwd=anih
提取码: anih 
附件 2：概念介绍
1. 轴承故障诊断与振动监测数据
列车轴承的工作环境往往较为恶劣，在长时间运行过程中，轴承部件可能因
过热、润滑不良、腐蚀等多种因素发生损坏，进而影响列车正常运行。轴承故障
诊断是指通过监测轴承运行状态下的各类信号（其中振动加速度信号为主要监测
数据），运用数据挖掘、信号处理及机器学习等技术手段，判定轴承是否存在故
障的技术。从本质上讲，基于机器学习的故障诊断问题属于模式识别问题——通
过信号处理等技术提取故障特征，再借助机器学习模型实现精准分类，是该领域
常见的实现路径。其核心目标在于实现对故障的提前预警与精准诊断，从而避免
设备突发性失效，为列车的安全运行提供可靠保障。
轴承结构主要包括内圈、外圈、滚动体和保持架四部分，其中典型故障多发
生在内圈、外圈和滚动体这三个核心承载部件。当轴承出现局部缺陷时，滚动体
在接触并通过缺陷点的瞬间，会产生突变的冲击脉冲，而在轴承周期性运转的过
程中，这种脉冲力会持续作用，进而形成周期性的冲击分量。在传感器采集的振
动信号中，由缺陷引发的周期冲击分量呈现为一系列类周期性的振动冲击及衰减
响应，示意图如图 1 所示。
图 1 列车轴承结构及轴承典型故障数据示意
这类轴承故障的频率特性通常由故障特征频率来描述，该频率可通过轴承转
速、滚动体数量、滚动体直径等固有参数计算得出，具体计算公式如表 2 所列。
表 2 轴承故障特征频率
名称 特征频率
外圈故障特征频率（Ball Pass 
Frequency on the Outer Race, BPFO）
𝑓𝑟
·
𝑁𝑑
2
· (1 −
𝑑
𝐷
)
内圈故障特征频率（Ball Pass 
Frequency on the Inner Race, BPFI）
𝑓𝑟
·
𝑁𝑑
2
· (1 +
𝑑
𝐷
)
滚动体故障特征频率（Ball Spin 
Frequency, BSF）
𝑓𝑟
·
𝐷
𝑑
[1 − (
𝑑
𝐷
)
2
]
表中，𝑓𝑟 =
𝑛
60 为轴承转频，n 为轴承内圈转速（单位：rpm），𝑑为滚动体直
径，𝐷为轴承节径（通常可由内径+外径
2 估算），𝑁𝑑为滚动体个数，轴承结构示意图
如图 2 所示。
图 2 轴承结构和参数示意图
常见的轴承数据集中，一般涵盖内圈故障、外圈故障和滚动体故障三种典
型故障类型，为故障诊断算法的训练与验证提供了基础数据支撑。
由于结构功能与受力特点存在差异，不同部位发生故障时，其振动信号呈现
出不同的特征，具体表现如下：
1）外圈故障
从时域上分析，轴承外圈故障信号如图 3 所示。
图 3 外圈故障示意图
图中𝑇𝑂为故障周期（相邻冲击的时间间隔），BPFO 为外圈故障特征频
率，二者互为倒数。由于外圈通常固定不动，在载荷方向不变的情况下，外圈
缺陷每次碰撞到滚动体的强度近似相同，因而理想情况下在时域上呈现等周期
等幅值的冲击分量。
2）内圈故障
由于内圈随轴旋转，当载荷方向不变时，故障点将周期性通过载荷区，导致
每次碰撞的强度不同。具体表现为振动信号的波形受到转频𝑓𝑟的调制，具有变化
的幅值。如图 4 所示。
图 4 内圈故障示意图
图中𝑇𝐼为故障周期，BPFI 为内圈故障特征频率，𝑇表示轴承的旋转周期，
为转频的倒数。
3）滚动体故障
与内圈故障相似，在载荷方向不变时，故障点和载荷的相对位置随滚动体的
旋转而发生周期性变化，表现为振动信号波形受到滚动体公转频率的调制。同时，
滚动体缺陷将随着滚动体自旋与内外圈发生交替碰撞，如图 5 所示。
图 5 滚动体故障示意图
图中𝑇𝐵为故障周期，BSF 为滚动体故障特征频率，二者互为倒数；𝑇𝐹为滚
动体公转周期，FTF 为滚动体公转频率，一般可通过FTF =
1
2
· 𝑓𝑟
[1 −
𝑑
𝐷
]计算，
二者互为倒数。
一般来说，结合轴承故障机理，通过统计学方法和信号处理技术，能够有效
降低背景噪声影响，有助于在采样信号中提取故障特征，从而提高深度学习模型
的学习效率和分类准确性。
2. 迁移学习
迁移学习（Transfer Learning）是一种机器学习方法，其利用在源域（源任务）
学习到的知识来改善目标域（目标任务）的学习效果，以减少目标域所需的训练
数据量，并提高学习效率。迁移学习包括两个重要概念：
1）领域（域）：模型学习的主体，主要由数据和其概率分布组成。本题包括
两个领域，即轴承试验台数据及其分布（源域）和实际运营列车数据及其分布（目
标域）。
2）任务：任务是模型在领域内要完成的具体目标，其数学本质是通过构建一
个预测函数来实现输入空间到标签空间的映射关系。其中，输入空间表示所有可
能的输入样本组成的集合，标签空间表示模型需要预测的输出值（标签）的集合。
本题中，具体任务包括轴承试验台数据的分类任务（源任务）和实际运营列车数
据的分类任务（目标任务）。
具体来说，给定一个源域𝐷𝑆和一个目标域𝐷𝑇，以及对应的任务𝑇𝑆和𝑇𝑇，迁移
学习的目标是找到一个映射函数ℎ ∈ 𝐻（𝐻为假设空间），使得ℎ在目标域 𝐷𝑇上的
预测误差最小化。常见的迁移学习方法包括基于特征的迁移、基于模型的迁移、
基于关系的迁移和基于样本的迁移四种类型。具体介绍如下：
1）基于特征的迁移：将源域和目标域数据映射到统一的特征空间，减少领域
间分布差异，进而实现迁移。常用方法包括特征转换[3]、对抗训练[4]等。
2）基于模型的迁移：复用源域模型的参数或结构，使其适配目标任务。常用
方法包括参数共享和微调[5]等。
3）基于关系的迁移：将源域中数据之间的关系模式迁移到目标域，如相似性、
依赖关系等。常用方法包括关系类比[6]、马尔可夫逻辑网络[7]等。
4）基于样本的迁移：通过调整源域样本的权重实现迁移。与目标域相似的样
本赋予高权重，使其发挥更大作用，不相似的样本则相反。常用方法包括重要性
加权、实例选择[8]等。
迁移学习的优势在于，其能够显著减少目标域的数据和标注需求，并能够提
高模型训练速度和泛化能力，以及解决无历史数据时的冷启动问题等。由于本题
的目标域无标签，请选择适用的迁移学习方法完成任务。

基于监督对比学习的轴承故障迁移诊断项目
项目名称: SCTL-FD (Supervised Contrastive Transfer Learning for Fault Diagnosis)
目标: 解决2025年中国研究生数学建模竞赛E题，构建一个能够从试验台架数据（源域）迁移到实际列车运行数据（目标域）的智能故障诊断模型。
核心方法论:
特征提取: 使用监督对比学习 (Supervised Contrastive Learning, SupCon) 在标签完备的源域数据集上预训练一个强大的1D-CNN特征提取器。
知识迁移: 将预训练的特征提取器应用于无标签的目标域数据，通过聚类生成伪标签，并进行模型微调 (Fine-tuning)，使模型适应目标域的数据分布。
可解释性: 通过t-SNE降维可视化和Grad-CAM等技术，对迁移过程和诊断结果进行解释。
技术栈:
语言: Python 3.9+
核心框架: PyTorch
科学计算与信号处理: NumPy, SciPy, Pandas
数据可视化: Matplotlib, Seaborn
机器学习: Scikit-learn (用于t-SNE和K-Means)
数据加载: scipy.io.loadmat (用于读取.mat文件)
项目实施步骤 (Step-by-Step Implementation Plan)
第一阶段：环境设置与项目结构
任务1: 创建项目目录结构
请按以下结构创建项目文件夹，以便管理代码、数据和结果。
code
Code
SCTL-FD/
├── data/
│   ├── source_domain/          # 存放源域CWRU数据集.mat文件
│   └── target_domain/          # 存放目标域列车数据.mat文件
├── processed_data/             # 存放预处理后的数据 (.npy或.pt)
├── src/
│   ├── preprocess.py         # 数据预处理脚本
│   ├── datasets.py           # PyTorch Dataset类定义
│   ├── models.py             # 模型架构定义 (Encoder, Head)
│   ├── losses.py             # SupCon Loss 定义
│   ├── train_supcon.py       # 监督对比学习预训练脚本
│   ├── train_transfer.py     # 迁移学习微调脚本
│   ├── predict.py            # 对目标域数据进行最终预测
│   └── explain.py            # 可解释性分析与可视化脚本
├── models_saved/               # 存放训练好的模型权重
├── results/
│   ├── plots/                  # 存放t-SNE等可视化图
│   └── predictions.csv         # 存放最终的预测结果
└── README.md                   # 项目说明
任务2: 安装所需库
请生成一个requirements.txt文件并安装。
code
Bash
pip install torch torchvision torchaudio numpy scipy pandas scikit-learn matplotlib seaborn
第二阶段：数据预处理 (preprocess.py)
目标: 将所有源域和目标域数据统一到32kHz采样率，并切片成固定长度的样本。
任务3: 定义全局常量
在preprocess.py顶部定义配置参数。
code
Python
# 全局配置
TARGET_SR = 32000  # 目标统一采样率
SAMPLE_LENGTH = 2048  # 每个样本的长度（数据点）
OVERLAP_RATIO = 0.5  # 切片时的重叠率
WINDOW_STEP = int(SAMPLE_LENGTH * (1 - OVERLAP_RATIO)) # 步长
任务4: 实现数据加载与重采样函数
编写一个函数，输入为.mat文件路径，输出为Numpy数组形式的振动信号和其原始采样率（12k, 48k或32k）。
编写一个核心的重采样函数 resample_signal(signal, original_sr, target_sr)。
使用 scipy.signal.resample 来实现。
该函数将是整个预处理流程的关键。
任务5: 实现信号切片与标签生成
编写一个函数，对重采样后的长时序信号进行滑动窗口切片，生成大量样本。
对于源域数据：根据文件名解析其故障类型（正常、内圈、外圈、滚珠）和工况，为每个切片样本生成对应的标签。建议将标签编码为数字（例如：0: Normal, 1: Inner, 2: Outer, 3: Ball）。
处理流程：
遍历data/source_domain/和data/target_domain/下的所有文件。
对每个文件：加载 -> 重采样至32kHz -> 切片。
将处理好的样本和标签（源域）保存到processed_data/目录。建议使用Numpy的.npz格式，可以同时存储数据和标签。例如 source_train.npz, target_unlabeled.npz。
第三阶段：模型架构与数据加载器 (models.py, datasets.py)
任务6: 定义模型组件 (models.py)
Encoder (特征提取器):
创建一个基于nn.Module的1D-CNN模型。
建议结构：3-4个卷积块，每个块包含Conv1d -> BatchNorm1d -> ReLU -> MaxPool1d。
最后使用nn.AdaptiveAvgPool1d(1)将输出展平为固定维度的特征向量h。
ProjectionHead (投影头):
一个简单的MLP，例如 Linear -> ReLU -> Linear。
输入是Encoder输出的特征h，输出是用于计算对比损失的低维表示z。
注意：此模块仅在SupCon预训练时使用。
ClassifierHead (分类头):
一个简单的nn.Linear层，输出维度等于故障类别数（4类）。
输入是Encoder输出的特征h。
任务7: 实现自定义Dataset类 (datasets.py)
SupConDataset (用于预训练):
继承torch.utils.data.Dataset。
在__getitem__方法中，对于一个索引idx，返回：
样本的两个不同增强视图 (view_1, view_2)。
该样本的标签。
需要实现一个数据增强的transform函数，对一维信号进行增强（例如，添加高斯噪声、随机缩放）。
StandardDataset (用于微调和测试):
一个常规的Dataset，__getitem__返回 (样本, 标签)。
任务8: 实现监督对比损失 (losses.py)
实现 SupConLoss 类。可以参考官方开源实现或相关论文的公式。它的核心是计算一个batch内所有正样本对和负样本对之间的对比关系。
第四阶段：模型训练 (train_supcon.py, train_transfer.py)
任务9: 实施源域预训练 (train_supcon.py)
加载使用SupConDataset处理过的源域数据。
实例化Encoder和ProjectionHead。
设置优化器（如AdamW）。
编写训练循环：
从dataloader获取 (view_1, view_2, labels)。
将两个视图分别通过 Encoder 和 ProjectionHead 得到 z1 和 z2。
将z1和z2拼接成一个特征矩阵，对应的标签也拼接起来。
将拼接后的特征矩阵和标签送入SupConLoss计算损失。
反向传播，更新参数。
训练结束后，只保存Encoder的权重到models_saved/encoder_pretrained.pth。
任务10: 实施迁移学习 (train_transfer.py)
步骤A：伪标签生成
加载预训练好的Encoder权重，并将其设置为评估模式 (.eval())。
加载所有目标域的无标签数据。
将所有目标域样本输入Encoder，提取它们的特征向量h。
使用sklearn.cluster.KMeans对这些特征向量进行聚类（n_clusters=4）。
将聚类结果作为目标域数据的伪标签。
步骤B：模型微调
加载预训练的Encoder权重。可以选择冻结前面几层卷积的参数。
实例化ClassifierHead。
使用StandardDataset加载目标域数据及其伪标签。
使用标准的交叉熵损失 (nn.CrossEntropyLoss) 进行训练。
关键：使用一个较小的学习率（例如1e-4），避免破坏预训练学到的知识。
训练结束后，保存整个微调后的模型（Encoder + ClassifierHead）到models_saved/final_model.pth。
第五阶段：预测与可解释性 (predict.py, explain.py)
任务11: 生成最终预测结果 (predict.py)
加载微调后的最终模型final_model.pth。
遍历data/target_domain/下的16个文件（A-P）。
对每个文件，进行与训练时完全相同的预处理（重采样、切片）。
对该文件的所有切片样本进行预测。
采用多数投票 (Majority Voting) 的策略，确定整个文件的最终故障标签。
将结果保存到results/predictions.csv，格式为 (文件名, 预测标签)。
任务12: 实现可解释性分析 (explain.py)
迁移过程可视化:
加载预训练的Encoder和微调后的Encoder。
分别提取源域测试集和目标域数据集的特征向量。
使用sklearn.manifold.TSNE将高维特征降到二维。
绘制散点图：
图1：预训练后，源域（按真实标签着色）和目标域（统一颜色）的分布。观察域差异。
图2：微调后，源域和目标域（按预测标签着色）的分布。观察目标域数据是否与源域相应类别对齐。
决策依据可视化 (可选，但建议):
为1D-CNN实现Grad-CAM。
对于一个目标域样本，可视化模型在做决策时关注了输入信号的哪些部分（例如，是否关注了冲击脉冲）。
请按照以上步骤，逐步完成每个脚本的编程任务。这个详细的计划将确保项目逻辑清晰，代码结构合理，最终能够有效地解决问题。